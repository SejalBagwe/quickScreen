{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fluid AI Hackathon</title>
</head>
<div>
<body style= 'font-family:Times New Roman;background-image:url("{%static "test-background.jpg"%}")'>
	<p id='timer' align = 'right' style = "font-size:20px;color:#0000b3;font-family:Times New Roman;"></p>	
	<p style = "font-size:18px;font-family:Times New Roman;color:#0000b3;width:50%;float:left"><b style = "font-size:20px;color:#000066;">Your Question:</b><br>
	Write a Javascript code to generate a hash which will be validated by a server. The hash will be based on the current epoch time. (epoch time is just a simple way computers use to represent current time as a single float variable. It is the number of seconds that have passed since 1st January, 1970).
	<br><br>
	<b style = "font-size:20px;color:#000066;">Method to do:</b><br>
	You can print the current epoch time in python by writing the following code:
	<br>
	<i>
	console.log(Date.now()/1000)
	<br><br>
	</i>
	#Output: 1473636383.373
	<br><br>
	First calculate the sum of all individual digits before the fullstop as sum1. Then calculate the sum of all individual digits after the fullstop as sum2.
	<br>
	Your hash final hash output will be:
	<br>
	(the current epoch time)-sum1-sum2.
	<br><br>
	<b style = "font-size:20px;color:#000066;">Expected Output:</b><br>
	That is, your generated hash output should look something like this:
	<br>
	<b>1473636383.373-44-13</b>
	<br><br><b style = "font-size:20px;color:#000066;">How to Submit:</b><br>
	Once you have generated this hash in python, take the above hash, and open the following link in your web browser:
	<br>
	<font color="blue">
	{{ site }}<b>your_hash</b><br>
	</font>
	(remember to replace your_hash with the hash that you generated)
	<br><br>
	That means something like this:
	<font color="blue">
	{{ site }}<b>1473636383.373-44-13</b>
	</font></p>
	<br><br>&nbsp;&nbsp;&nbsp;&nbsp;
	<b style = "font-size:20px;color:#000066;">Remember the following Points:</b><br>
	<p style = "font-size:18px;color:#0000b3;">&nbsp;&nbsp;&nbsp;&nbsp;1)The hash needs to be generated using Javascript code. <br>
	&nbsp;&nbsp;&nbsp;&nbsp;2)The quality of your Javascript code will be checked.<br>
	&nbsp;&nbsp;&nbsp;&nbsp;3)Also the generated hash needs to be of a current time.<br>
	&nbsp;&nbsp;&nbsp;&nbsp;4)Marks deducted on generating every unsuccessful Hash.<br>
	&nbsp;&nbsp;&nbsp;&nbsp;5)After 5 minutes of the test, marks will be deducted for each minute.</p>
	<p style = "font-size:18px;color:#0000b3;" ><b style = "font-size:20px;color:#000066;">&nbsp;&nbsp;&nbsp;&nbsp;Note that helps you:</b><br>
	&nbsp;&nbsp;&nbsp;&nbsp;You have to write the Javascript code in the editor on your right.
	<br>
	&nbsp;&nbsp;&nbsp;&nbsp;If you don't have Javascript installed on your machine, please inform the HR.</p>

	<p style = "font-size:20px;color:#000066;" align='center'><b>JAVASCRIPT EDITOR</b></p>
	<br>
</div>
<div style="width:40%;float:left;margin-left:7%;border-color:black">

    <textarea style="width:80%;height:250px;background-color:black;color:white;" name="javascript_code" id="javascript_code">//Write your javascript code here
console.log(Date.now()/1000);</textarea>
    <br>
    <input type="button" name="runCode" value="Run Code" onclick="evaluateJavascript()" style="margin-bottom:50px;" />
	&nbsp;&nbsp;
    <b id="resultDiv">
    </b>

</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script type="text/javascript">

//Redirecting Console Output to be available
var consoleValue = "";
console.originalLog = console.log;

console.log = function(value)
{
    console.originalLog(value);
    consoleValue += "" + value;
    return value;
};

//Javascript Evaluator of Code
function evaluateJavascript()
{
    var code = $('textarea#javascript_code').val();

    var result = "";
    try
    {
        result = eval(code);
    }
    catch (e)
    {
        consoleValue += "" + e;
        //result = e;
    }

    result = "<b>OUTPUT: </b>" + consoleValue;

    consoleValue = "";

    $('#resultDiv').html(result);
}

//Allowing tab to work in textarea
$(document).delegate('#javascript_code', 'keydown', function(e) {
  var keyCode = e.keyCode || e.which;

  if (keyCode == 9) {
    e.preventDefault();
    var start = this.selectionStart;
    var end = this.selectionEnd;

    // set textarea value to: text before caret + tab + text after caret
    $(this).val($(this).val().substring(0, start)
                + "\t"
                + $(this).val().substring(end));

    // put caret at right position again
    this.selectionStart =
    this.selectionEnd = start + 1;
  }
});

//Prevent Refresh of the Page
window.onbeforeunload = function() {
     return "If you refresh this page your test will end! Are you sure you want to do that?";
}
</script>
<script> 
	var currentdate = new Date(); 
	var deadline = new Date("{{time}}").getTime(); 
	var x = setInterval(function() { 
	var now = new Date().getTime(); 
	var t = deadline - now; 
	var days = Math.floor(t / (1000 * 60 * 60 * 24)); 
	var hours = Math.floor((t%(1000 * 60 * 60 * 24))/(1000 * 60 * 60)); 
	var minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60)); 
	var seconds = Math.floor((t % (1000 * 60)) / 1000); 
	document.getElementById("timer").innerHTML = "Time: " + hours + "hr " + minutes + "min " + seconds + "sec "; 
		if (t < 0) { 
			clearInterval(x);
			alert("I am an alert box!");
			
			window.location.replace("http://127.0.0.1:8000/");
		} 
	}, 1000); 
	</script> 
<br><br>
</body>
</html>